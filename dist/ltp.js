!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.ltp=r():t.ltp=r()}(window,(function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var a in t)e.d(n,a,function(r){return t[r]}.bind(null,a));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=1)}([function(t,r,e){"use strict";class n extends Error{constructor(t,r,e){if(super(e),this.CONTEXT_LENGTH=10,this.name="BracketedError",t){let e=r+this.CONTEXT_LENGTH>t.length?t.length:r+this.CONTEXT_LENGTH,n="Missing closing brace: ";n+=t.substr(r,e),this.message=n}}}let a={bracketPairs:{"(":")","{":"}","[":"]"},get(t,r){return r||(r=0),t.substring(r+1,this.findEnd(t,r))},findEnd(t,r){let e,a,s=[];for(let n of Object.keys(this.bracketPairs))t[r]==n&&(e=n,a=this.bracketPairs[n]);if(null==e)throw new n(void 0,void 0,"Expression not starting with a bracket was sent to bracket parser.");s.push(e);let o=r;for(;s.length>0;){if(++o>t.length-1)throw new n(t,r);t[o]==e?s.push(e):t[o]==a&&s.pop()}return o}};t.exports=a},function(t,r,e){"use strict";t.exports=function(t){let r=e(2),n=e(3),a=e(4);var s,o;try{return s=r.clean(t),o=a.parse(s),n.translate(o)}catch(t){console.log(t)}}},function(t,r,e){"use strict";let n=e(0);class a extends Error{constructor(t,r,e){if(super(e),this.name="CleanerError",this.CONTEXT_LENGTH=10,t){let n=r+this.CONTEXT_LENGTH>t.length?t.length:r+this.CONTEXT_LENGTH,a=t.substr(r,n);this.message=e+":"+a}}}let s={clean(t){let r=t;for(t=this.doCleaning(t);r!=t;)r=t,t=this.doCleaning(t);return t},doCleaning(t){return t=this.cleanTextColor(t),t=this.cleanOperators(t),t=this.cleanLeftRight(t),t=this.cleanText(t),t=this.cleanThingies(t)},cleanTextColor(t){return this.cleanArgumented(t,"\\textcolor",2,2)},cleanText(t){return this.cleanArgumentedRemove(t,"\\text",1)},cleanLeftRight:t=>t.replace(/(\\left)|(\\right)/gi,""),cleanThingies(t){let r=/\[\d+?pt\]/gi;return t=t.replace(r,""),r="&",t=t.replace(r," ")},cleanOperators(t){var r;return r=/(\\cdot)|(\\times)/gi,t=t.replace(r,"*"),r="\\div",t=t.replace(r,"/"),r=/(\\leq)|(\\lt)|(\\geq)|(\\gt)/gi,t=t.replace(r,t=>{switch(t){case"\\leq":return"<=";case"\\lt":return"<";case"\\geq":return">=";case"\\gt":return">"}})},indexedReplacement(t,r,e,n){let a=t.slice(0,r)+n;return{expression:a+t.slice(e,t.length),replacementEndPos:a.length-1}},cleanArgumented(t,r,e,s){let o=r,u=t.indexOf(o,0);for(;-1!=u;){let r=u+(o.length-1),i=0;for(let s=0;s<e-1;++s){if(-1==(i=t.indexOf("{",r)))throw new a(t,u,"Missing arguments");r=n.findEnd(t,i)}if(-1==(i=t.indexOf("{",r)))throw new a(t,u,"Missing arguments");let c=n.get(t,i);r=n.findEnd(t,i);for(let o=e;o<s;++o){if(-1==(i=t.indexOf("{",r)))throw new a(t,u,"Missing arguments");r=n.findEnd(t,i)}let l=this.indexedReplacement(t,u,r+1,c);u=(t=l.expression).indexOf(o,l.replacementEndPos)}return t},cleanArgumentedRemove(t,r,e){let s=r,o=t.indexOf(s,0);for(;-1!=o;){let r=o+(s.length-1);for(let u=0;u<e;++u){let e=t.indexOf("{",r);if(-1==e)throw new a(t,o,"Missing arguments");r=n.findEnd(t,e);let u=this.indexedReplacement(t,o,r+1,"");o=(t=u.expression).indexOf(s,u.replacementEndPos)}}return t}};t.exports=s},function(t,r,e){"use strict";let n=e(0);class a extends Error{constructor(t){super("Unknown entity encountered."),console.log("Object that caused translator error:"),console.log(t),this.name="TranslatorError",this.problem=t}}let s={translate(t){var r;switch(t.type){case"root":r=this.translateRoot(t);break;case"environment":r=this.translateEnvironment(t);break;case"expression":r=this.translateExpression(t);break;case"function":r=this.translateFunction(t);break;case"calcunit":r=this.translateCalcunit(t);break;case"char":r=this.translateChar(t);break;default:throw new a(t)}return r},translateRoot(t){for(let r of t.arg)this.translateExpression(r)},translateExpression(t){var r,e,n;switch(t.bracketType){case"curly":e="{",n="}";break;case"round":e="(",n=")";break;case"square":e="[",n="]";break;default:e="",n=""}r=e;for(let e of t.arg)switch(e.type){case"root":r+=this.translateRoot(e);break;case"environment":r+=this.translateEnvironment(e);break;case"expression":r+=this.translateExpression(e);break;case"function":r+=this.translateFunction(e);break;case"calcunit":r+=this.translateCalcunit(e);break;case"char":r+=e.arg;break;default:throw new a(e)}return r+=n},translateChar:t=>t.arg,translateFunction(t){let r=t.name,e=this.funcTranslations[r];for(let r=0;r<t.arg.length;++r)t.arg[r]=s.translate(t.arg[r]),"{"!=t.arg[r][0]&&"["!=t.arg[r][0]||(t.arg[r]=n.get(t.arg[r]));return t.exponent?"{"+e(t)+"}^"+this.translate(t.exponent):e(t)},translateCalcunit(t){var r="";for(let e of t.arg)r+=this.translateChar(e);return r},translateRoot(t){var r="";for(let e of t.arg)r+=this.translateExpression(e);return r},funcTranslations:{regular:t=>`${t.arg[0]}(${t.arg[1]})`,abs:t=>`abs(${t.arg[0]})`,sqrt:t=>2==t.arg.length?`root(${t.arg[0]}, ${t.arg[1]})`:`root2(${t.arg[0]})`,integral:t=>2==t.arg.length?`integral(${t.arg[0]}, ${t.arg[1]})`:`definiteintegral(${t.arg[0]}, ${t.arg[1]}, ${t.arg[2]}, ${t.arg[3]})`,fraction:t=>`{{${t.arg[0]}}/{${t.arg[1]}}}`,derivative:t=>`derivation(${t.arg[1]}, ${t.arg[2]})`,latex_function:t=>(t.arg[1]=n.get(t.arg[1]),`function(${t.arg[0]}, ${t.arg[1]})=${t.arg[2]}`),latex_function_inverse:t=>(t.arg[1]=n.get(t.arg[1]),`function_inverse(${t.arg[0]}, ${t.arg[1]})=${t.arg[2]}`),binomial:t=>`choose(${t.arg[0]}, ${t.arg[1]})`,logarithm:t=>`log(${t.arg[0]}, ${t.arg[1]})`,logarithm_10:t=>`log10(${t.arg[0]})`,logarithm_ln:t=>`ln(${t.arg[0]})`,limit:t=>`lim(${t.arg[0]}, ${t.arg[1]}, ${t.arg[2]})`,mean:t=>`mean(${t.arg[0]})`,degrees:t=>`deg(${t.arg[0]})`},translateEnvironment(t){var r;switch(t.envType){case"system":r=this.translateEnvironmentSystem(t);break;case"determinant":r=this.translateEnvironmentDeterminant(t);default:throw new a(t)}return r},translateEnvironmentSystem(t){let r=[];for(let e of t.arg)r.push(this.translate(e));return"system("+r.join(",")+")"}};t.exports=s},function(t,r,e){"use strict";function n(t,r,e,a){this.message=t,this.expected=r,this.found=e,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}(n,Error),n.buildMessage=function(t,r){var e={literal:function(t){return'"'+a(t.text)+'"'},class:function(t){var r,e="";for(r=0;r<t.parts.length;r++)e+=t.parts[r]instanceof Array?s(t.parts[r][0])+"-"+s(t.parts[r][1]):s(t.parts[r]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function a(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){var r,n,a,s=new Array(t.length);for(r=0;r<t.length;r++)s[r]=(a=t[r],e[a.type](a));if(s.sort(),s.length>0){for(r=1,n=1;r<s.length;r++)s[r-1]!==s[r]&&(s[n]=s[r],n++);s.length=n}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+a(t)+'"':"end of input"}(r)+" found."},t.exports={SyntaxError:n,parse:function(t,r){r=void 0!==r?r:{};var e,a={},s={root:Ge},o=Ge,u=function(t){return new an("root",t)},i=function(t){return new un(t)},c="{",l=Ne("{",!1),f="}",h=Ne("}",!1),g=function(t){let r=[];return r.push(t),new un(r,"curly")},d="(",p=Ne("(",!1),b=")",m=Ne(")",!1),v=function(t){let r=[];return r.push(t),new un(r,"round")},x="[",C=Ne("[",!1),A="]",w=Ne("]",!1),y=function(t){let r=[];return r.push(t),new un(r,"square")},E=function(t){return t},T="^",$=Ne("^",!1),_="\\circ",k=Ne("\\circ",!1),O=function(t){return new sn("degrees",[t])},j=qe("function"),R=function(t){return t},N="f",S=Ne("f",!1),q="g",F=Ne("g",!1),M="h",P=Ne("h",!1),L=function(t){return new cn(t)},G=function(t){return t},H="|",X=Ne("|",!1),z=function(t){return new sn("abs",[t])},U="\\displaystyle",Z=Ne("\\displaystyle",!1),B="\\binom",D=Ne("\\binom",!1),I=function(t,r){return new sn("binomial",[t,r])},J="\\log",K=Ne("\\log",!1),Q="_",V=Ne("_",!1),W="10",Y=Ne("10",!1),tt=function(t){return new sn("logarithm_10",[t])},rt=function(t,r){return new sn("logarithm",[t,r])},et="\\ln",nt=Ne("\\ln",!1),at=function(t){return new sn("logarithm_ln"[t])},st=function(t,r){return new sn("logartihm_10",[r],t)},ot=function(t,r){return new sn("logarithm_10",[r],t)},ut=function(t,r,e){return new sn("logarithm",[r,e],t)},it=function(t,r){return new sn("logarithm_ln",[r],t)},ct="\\lim",lt=Ne("\\lim",!1),ft=function(t,r){return new sn("limit",[...t,r])},ht="\\longrightarrow",gt=Ne("\\longrightarrow",!1),dt=function(t,r){return[t,r]},pt="=",bt=Ne("=",!1),mt=function(t,r,e){return new sn("latex_function",[t,r,e])},vt="-",xt=Ne("-",!1),Ct="1",At=Ne("1",!1),wt=function(t,r,e){return new sn("latex_function_inverse",[t,r,e])},yt="'",Et=Ne("'",!1),Tt="\\prime",$t=Ne("\\prime",!1),_t=function(t,r,e){return new sn("derivative",[t,r,e])},kt="\\",Ot=Ne("\\",!1),jt=function(t,r){return new sn("regular",[t,r])},Rt=function(t,r,e){return new sn("regular",[t,e],r)},Nt=function(t){return new cn(nn[t])},St="\\frac",qt=Ne("\\frac",!1),Ft=function(t,r){return new sn("fraction",[t,r])},Mt="\\overline",Pt=Ne("\\overline",!1),Lt=function(t){return new sn("mean",[t])},Gt="sinh",Ht=Ne("sinh",!1),Xt="cosh",zt=Ne("cosh",!1),Ut="coth",Zt=Ne("coth",!1),Bt="cos",Dt=Ne("cos",!1),It="sec",Jt=Ne("sec",!1),Kt="tan",Qt=Ne("tan",!1),Vt="cot",Wt=Ne("cot",!1),Yt="ctg",tr=Ne("ctg",!1),rr="csc",er=Ne("csc",!1),nr="sin",ar=Ne("sin",!1),sr="acos",or=Ne("acos",!1),ur="asin",ir=Ne("asin",!1),cr="arcsin",lr=Ne("arcsin",!1),fr="arccos",hr=Ne("arccos",!1),gr="arcctg",dr=Ne("arcctg",!1),pr="arccot",br=Ne("arccot",!1),mr="arctan",vr=Ne("arctan",!1),xr=function(t){return new cn(t)},Cr="\\sqrt",Ar=Ne("\\sqrt",!1),wr=function(t){return new sn("sqrt",[t])},yr=function(t,r){return new sn("sqrt",[t,r])},Er="\\int",Tr=Ne("\\int",!1),$r="d",_r=Ne("d",!1),kr=function(t,r){return new sn("integral",[t,r])},Or=function(t,r,e,n){return new sn("integral",[t,r,e,n])},jr=function(t,r,e,n){return new sn("integral",[r,t,e,n])},Rr=qe("environment"),Nr="\\begin",Sr=Ne("\\begin",!1),qr="{cases}",Fr=Ne("{cases}",!1),Mr="\\end",Pr=Ne("\\end",!1),Lr=function(t,r){return t.push(r),new ln("system",t)},Gr="\\\\",Hr=Ne("\\\\",!1),Xr=qe("number"),zr=" ",Ur=Ne(" ",!1),Zr=function(t){let r=[];for(let e of t)" "!=e&&r.push(e);return new on(r)},Br=/^[+\-*\/\^=<>._]/,Dr=Se(["+","-","*","/","^","=","<",">",".","_"],!1,!1),Ir=function(t){return new cn(t)},Jr=/^[a-zA-Z+\-*\/]/,Kr=Se([["a","z"],["A","Z"],"+","-","*","/"],!1,!1),Qr=function(t){return new cn(t)},Vr=function(t){return new cn(nn[t])},Wr=qe("special symbol"),Yr="\\pi",te=Ne("\\pi",!1),re="\\infty",ee=Ne("\\infty",!1),ne="\\alpha",ae=Ne("\\alpha",!1),se="\\beta",oe=Ne("\\beta",!1),ue="\\lambda",ie=Ne("\\lambda",!1),ce="\\gamma",le=Ne("\\gamma",!1),fe="\\epsilon",he=Ne("\\epsilon",!1),ge="\\rho",de=Ne("\\rho",!1),pe="\\delta",be=Ne("\\delta",!1),me="\\sigma",ve=Ne("\\sigma",!1),xe="\\theta",Ce=Ne("\\theta",!1),Ae=qe("whitespace or endline"),we=/^[ \t\r\n]/,ye=Se([" ","\t","\r","\n"],!1,!1),Ee=/^[0-9.]/,Te=Se([["0","9"],"."],!1,!1),$e=function(t){return new cn(t.join(""))},_e=0,ke=[{line:1,column:1}],Oe=0,je=[],Re=0;if("startRule"in r){if(!(r.startRule in s))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=s[r.startRule]}function Ne(t,r){return{type:"literal",text:t,ignoreCase:r}}function Se(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function qe(t){return{type:"other",description:t}}function Fe(r){var e,n=ke[r];if(n)return n;for(e=r-1;!ke[e];)e--;for(n={line:(n=ke[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return ke[r]=n,n}function Me(t,r){var e=Fe(t),n=Fe(r);return{start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function Pe(t){_e<Oe||(_e>Oe&&(Oe=_e,je=[]),je.push(t))}function Le(t,r,e){return new n(n.buildMessage(t,r),t,r,e)}function Ge(){var t,r,e;for(t=_e,r=[],e=He();e!==a;)r.push(e),e=He();return r!==a&&(t,r=u(r)),t=r}function He(){var t,r,e;if(t=_e,r=[],(e=Ze())!==a)for(;e!==a;)r.push(e),e=Ze();else r=a;return r!==a&&(t,r=i(r)),(t=r)===a&&(t=Xe())===a&&(t=ze())===a&&(t=Ue()),t}function Xe(){var r,e,n,s;return r=_e,123===t.charCodeAt(_e)?(e=c,_e++):(e=a,0===Re&&Pe(l)),e!==a&&(n=Ge())!==a?(125===t.charCodeAt(_e)?(s=f,_e++):(s=a,0===Re&&Pe(h)),s!==a?(r,r=e=g(n)):(_e=r,r=a)):(_e=r,r=a),r}function ze(){var r,e,n,s;return r=_e,40===t.charCodeAt(_e)?(e=d,_e++):(e=a,0===Re&&Pe(p)),e!==a&&(n=Ge())!==a?(41===t.charCodeAt(_e)?(s=b,_e++):(s=a,0===Re&&Pe(m)),s!==a?(r,r=e=v(n)):(_e=r,r=a)):(_e=r,r=a),r}function Ue(){var r,e,n,s;return r=_e,91===t.charCodeAt(_e)?(e=x,_e++):(e=a,0===Re&&Pe(C)),e!==a&&(n=Ge())!==a?(93===t.charCodeAt(_e)?(s=A,_e++):(s=a,0===Re&&Pe(w)),s!==a?(r,r=e=y(n)):(_e=r,r=a)):(_e=r,r=a),r}function Ze(){var r,e;return r=_e,(e=function(){var r;Re++,(r=function(){var r,e,n,s;r=_e,92===t.charCodeAt(_e)?(e=kt,_e++):(e=a,0===Re&&Pe(Ot));e!==a&&(n=Ke())!==a&&(s=Je())!==a?(r,e=jt(n,s),r=e):(_e=r,r=a);r===a&&(r=function(){var r,e,n,s,o,u;r=_e,92===t.charCodeAt(_e)?(e=kt,_e++):(e=a,0===Re&&Pe(Ot));e!==a&&(n=Ke())!==a&&rn()!==a?(94===t.charCodeAt(_e)?(s=T,_e++):(s=a,0===Re&&Pe($)),s!==a&&(o=Be())!==a&&(u=Je())!==a?(r,e=Rt(n,o,u),r=e):(_e=r,r=a)):(_e=r,r=a);return r}());return r}())===a&&(r=function(){var r,e,n,s;r=_e,t.substr(_e,5)===St?(e=St,_e+=5):(e=a,0===Re&&Pe(qt));e!==a&&(n=Ie())!==a&&(s=Ie())!==a?(r,e=Ft(n,s),r=e):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s;r=_e,124===t.charCodeAt(_e)?(e=H,_e++):(e=a,0===Re&&Pe(X));e!==a&&(n=Ge())!==a?(124===t.charCodeAt(_e)?(s=H,_e++):(s=a,0===Re&&Pe(X)),s!==a?(r,e=z(n),r=e):(_e=r,r=a)):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n;r=_e,t.substr(_e,9)===Mt?(e=Mt,_e+=9):(e=a,0===Re&&Pe(Pt));e!==a&&(n=Ie())!==a?(r,e=Lt(n),r=e):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s;r=_e,t.substr(_e,5)===Cr?(e=Cr,_e+=5):(e=a,0===Re&&Pe(Ar));e!==a&&(n=Ie())!==a?(r,e=wr(n),r=e):(_e=r,r=a);r===a&&(r=_e,t.substr(_e,5)===Cr?(e=Cr,_e+=5):(e=a,0===Re&&Pe(Ar)),e!==a&&(n=Ue())!==a&&(s=Ie())!==a?(r,e=yr(n,s),r=e):(_e=r,r=a));return r}())===a&&(r=function(){var r,e,n,s,o,u,i,c,l,f,h;r=_e,t.substr(_e,13)===U?(e=U,_e+=13):(e=a,0===Re&&Pe(Z));e!==a&&rn()!==a?(t.substr(_e,4)===Er?(n=Er,_e+=4):(n=a,0===Re&&Pe(Tr)),n!==a&&(s=Ie())!==a&&(o=rn())!==a?(100===t.charCodeAt(_e)?(u=$r,_e++):(u=a,0===Re&&Pe(_r)),u!==a&&(i=rn())!==a&&(c=Qe())!==a?(r,e=kr(s,c),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);r===a&&(r=_e,t.substr(_e,13)===U?(e=U,_e+=13):(e=a,0===Re&&Pe(Z)),e!==a&&rn()!==a?(t.substr(_e,4)===Er?(n=Er,_e+=4):(n=a,0===Re&&Pe(Tr)),n!==a&&(s=rn())!==a?(95===t.charCodeAt(_e)?(o=Q,_e++):(o=a,0===Re&&Pe(V)),o!==a&&(u=Ie())!==a?(94===t.charCodeAt(_e)?(i=T,_e++):(i=a,0===Re&&Pe($)),i!==a&&(c=Ie())!==a&&(l=Ie())!==a&&rn()!==a?(100===t.charCodeAt(_e)?(f=$r,_e++):(f=a,0===Re&&Pe(_r)),f!==a&&rn()!==a&&(h=Qe())!==a?(r,e=Or(u,c,l,h),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a),r===a&&(r=_e,t.substr(_e,13)===U?(e=U,_e+=13):(e=a,0===Re&&Pe(Z)),e!==a&&rn()!==a?(t.substr(_e,4)===Er?(n=Er,_e+=4):(n=a,0===Re&&Pe(Tr)),n!==a&&(s=rn())!==a?(94===t.charCodeAt(_e)?(o=T,_e++):(o=a,0===Re&&Pe($)),o!==a&&(u=Ie())!==a?(95===t.charCodeAt(_e)?(i=Q,_e++):(i=a,0===Re&&Pe(V)),i!==a&&(c=Ie())!==a&&(l=Ie())!==a&&rn()!==a?(100===t.charCodeAt(_e)?(f=$r,_e++):(f=a,0===Re&&Pe(_r)),f!==a&&rn()!==a&&(h=Qe())!==a?(r,e=jr(u,c,l,h),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)));return r}())===a&&(r=function(){var r,e,n,s,o;r=_e,t.substr(_e,13)===U?(e=U,_e+=13):(e=a,0===Re&&Pe(Z));e!==a&&rn()!==a?(t.substr(_e,6)===B?(n=B,_e+=6):(n=a,0===Re&&Pe(D)),n!==a&&(s=Ie())!==a&&(o=Ie())!==a?(r,e=I(s,o),r=e):(_e=r,r=a)):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s,o,u,i,g,d,p;r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K));e!==a&&(n=rn())!==a?(95===t.charCodeAt(_e)?(s=Q,_e++):(s=a,0===Re&&Pe(V)),s!==a?(o=_e,123===t.charCodeAt(_e)?(u=c,_e++):(u=a,0===Re&&Pe(l)),u!==a&&(i=rn())!==a?(t.substr(_e,2)===W?(g=W,_e+=2):(g=a,0===Re&&Pe(Y)),g!==a&&(d=rn())!==a?(125===t.charCodeAt(_e)?(p=f,_e++):(p=a,0===Re&&Pe(h)),p!==a?o=u=[u,i,g,d,p]:(_e=o,o=a)):(_e=o,o=a)):(_e=o,o=a),o===a&&(t.substr(_e,2)===W?(o=W,_e+=2):(o=a,0===Re&&Pe(Y))),o!==a&&(u=Ie())!==a?(r,e=tt(u),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);r===a&&(r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K)),e!==a&&(n=Ie())!==a?(r,e=tt(n),r=e):(_e=r,r=a),r===a&&(r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K)),e!==a&&(n=rn())!==a?(95===t.charCodeAt(_e)?(s=Q,_e++):(s=a,0===Re&&Pe(V)),s!==a&&(o=Ie())!==a&&(u=Ie())!==a?(r,e=rt(o,u),r=e):(_e=r,r=a)):(_e=r,r=a),r===a&&(r=_e,t.substr(_e,3)===et?(e=et,_e+=3):(e=a,0===Re&&Pe(nt)),e!==a&&(n=Ie())!==a?(r,e=at(n),r=e):(_e=r,r=a),r===a&&(r=function(){var r,e,n,s,o,u,i,g,d,p,b;r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K));e!==a&&rn()!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&(s=Be())!==a?(95===t.charCodeAt(_e)?(o=Q,_e++):(o=a,0===Re&&Pe(V)),o!==a?(u=_e,123===t.charCodeAt(_e)?(i=c,_e++):(i=a,0===Re&&Pe(l)),i!==a&&(g=rn())!==a?(t.substr(_e,2)===W?(d=W,_e+=2):(d=a,0===Re&&Pe(Y)),d!==a&&(p=rn())!==a?(125===t.charCodeAt(_e)?(b=f,_e++):(b=a,0===Re&&Pe(h)),b!==a?u=i=[i,g,d,p,b]:(_e=u,u=a)):(_e=u,u=a)):(_e=u,u=a),u===a&&(t.substr(_e,2)===W?(u=W,_e+=2):(u=a,0===Re&&Pe(Y))),u!==a&&(i=Ie())!==a?(r,e=st(s,i),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);r===a&&(r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K)),e!==a&&rn()!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&(s=Be())!==a&&(o=Ie())!==a?(r,e=ot(s,o),r=e):(_e=r,r=a)):(_e=r,r=a),r===a&&(r=_e,t.substr(_e,4)===J?(e=J,_e+=4):(e=a,0===Re&&Pe(K)),e!==a&&rn()!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&(s=Be())!==a?(95===t.charCodeAt(_e)?(o=Q,_e++):(o=a,0===Re&&Pe(V)),o!==a&&(u=Ie())!==a&&(i=Ie())!==a?(r,e=ut(s,u,i),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a),r===a&&(r=_e,t.substr(_e,3)===et?(e=et,_e+=3):(e=a,0===Re&&Pe(nt)),e!==a&&rn()!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&(s=Be())!==a&&(o=Ie())!==a?(r,e=it(s,o),r=e):(_e=r,r=a)):(_e=r,r=a))));return r}()))));return r}())===a&&(r=function(){var r,e,n,s,o,u;r=_e,t.substr(_e,13)===U?(e=U,_e+=13):(e=a,0===Re&&Pe(Z));e!==a&&rn()!==a?(t.substr(_e,4)===ct?(n=ct,_e+=4):(n=a,0===Re&&Pe(lt)),n!==a&&rn()!==a?(95===t.charCodeAt(_e)?(s=Q,_e++):(s=a,0===Re&&Pe(V)),s!==a&&rn()!==a&&(o=function(){var r,e,n,s,o,u;r=_e,123===t.charCodeAt(_e)?(e=c,_e++):(e=a,0===Re&&Pe(l));e!==a&&rn()!==a&&(n=Qe())!==a&&rn()!==a?(t.substr(_e,15)===ht?(s=ht,_e+=15):(s=a,0===Re&&Pe(gt)),s!==a&&rn()!==a&&(o=Qe())!==a&&rn()!==a?(125===t.charCodeAt(_e)?(u=f,_e++):(u=a,0===Re&&Pe(h)),u!==a?(r,e=dt(n,o),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);return r}())!==a&&(u=Ie())!==a?(r,e=ft(o,u),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s,o,u,i,c;r=_e,(e=De())!==a&&rn()!==a?(39===t.charCodeAt(_e)?(n=yt,_e++):(n=a,0===Re&&Pe(Et)),n===a&&(t.substr(_e,6)===Tt?(n=Tt,_e+=6):(n=a,0===Re&&Pe($t))),n!==a&&rn()!==a?(40===t.charCodeAt(_e)?(s=d,_e++):(s=a,0===Re&&Pe(p)),s!==a&&rn()!==a&&(o=Qe())!==a&&rn()!==a?(41===t.charCodeAt(_e)?(u=b,_e++):(u=a,0===Re&&Pe(m)),u!==a&&rn()!==a?(61===t.charCodeAt(_e)?(i=pt,_e++):(i=a,0===Re&&Pe(bt)),i!==a&&(c=Ge())!==a?(r,e=_t(e,o,c),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s,o;r=_e,(e=De())!==a&&rn()!==a&&(n=ze())!==a?(61===t.charCodeAt(_e)?(s=pt,_e++):(s=a,0===Re&&Pe(bt)),s!==a&&(o=Ge())!==a?(r,e=mt(e,n,o),r=e):(_e=r,r=a)):(_e=r,r=a);return r}())===a&&(r=function(){var r,e,n,s,o,u,i,g,d,p;r=_e,(e=De())!==a&&rn()!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&rn()!==a?(123===t.charCodeAt(_e)?(s=c,_e++):(s=a,0===Re&&Pe(l)),s!==a&&rn()!==a?(45===t.charCodeAt(_e)?(o=vt,_e++):(o=a,0===Re&&Pe(xt)),o!==a?(49===t.charCodeAt(_e)?(u=Ct,_e++):(u=a,0===Re&&Pe(At)),u!==a&&rn()!==a?(125===t.charCodeAt(_e)?(i=f,_e++):(i=a,0===Re&&Pe(h)),i!==a&&rn()!==a&&(g=ze())!==a?(61===t.charCodeAt(_e)?(d=pt,_e++):(d=a,0===Re&&Pe(bt)),d!==a&&(p=Ge())!==a?(r,e=wt(e,g,p),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);return r}());Re--,r===a&&(a,0===Re&&Pe(j));return r}())!==a&&(r,e=E(e)),(r=e)===a&&(r=_e,(e=function(){var r,e,n,s,o,u,i,g,d,p;r=_e,(e=en())!==a&&(n=rn())!==a?(94===t.charCodeAt(_e)?(s=T,_e++):(s=a,0===Re&&Pe($)),s!==a&&(o=rn())!==a?(123===t.charCodeAt(_e)?(u=c,_e++):(u=a,0===Re&&Pe(l)),u!==a&&(i=rn())!==a?(t.substr(_e,5)===_?(g=_,_e+=5):(g=a,0===Re&&Pe(k)),g!==a&&(d=rn())!==a?(125===t.charCodeAt(_e)?(p=f,_e++):(p=a,0===Re&&Pe(h)),p!==a?(r,e=O(e),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a);r===a&&(r=_e,(e=Ie())!==a?(94===t.charCodeAt(_e)?(n=T,_e++):(n=a,0===Re&&Pe($)),n!==a&&(s=rn())!==a?(123===t.charCodeAt(_e)?(o=c,_e++):(o=a,0===Re&&Pe(l)),o===a&&(o=null),o!==a&&(u=rn())!==a?(t.substr(_e,5)===_?(i=_,_e+=5):(i=a,0===Re&&Pe(k)),i!==a&&(g=rn())!==a?(125===t.charCodeAt(_e)?(d=f,_e++):(d=a,0===Re&&Pe(h)),d===a&&(d=null),d!==a?(r,e=O(e),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a));return r}())!==a&&(r,e=E(e)),(r=e)===a&&(r=_e,(e=function(){var r;Re++,r=function(){var r,e,n,s,o,u,i;r=_e,t.substr(_e,6)===Nr?(e=Nr,_e+=6):(e=a,0===Re&&Pe(Sr));if(e!==a)if(rn()!==a)if(t.substr(_e,7)===qr?(n=qr,_e+=7):(n=a,0===Re&&Pe(Fr)),n!==a){if(s=[],(o=Ve())!==a)for(;o!==a;)s.push(o),o=Ve();else s=a;s!==a&&(o=Ge())!==a?(t.substr(_e,4)===Mr?(u=Mr,_e+=4):(u=a,0===Re&&Pe(Pr)),u!==a&&rn()!==a?(t.substr(_e,7)===qr?(i=qr,_e+=7):(i=a,0===Re&&Pe(Fr)),i!==a?(r,e=Lr(s,o),r=e):(_e=r,r=a)):(_e=r,r=a)):(_e=r,r=a)}else _e=r,r=a;else _e=r,r=a;else _e=r,r=a;return r}(),Re--,r===a&&(a,0===Re&&Pe(Rr));return r}())!==a&&(r,e=E(e)),(r=e)===a&&(r=_e,(e=function(){var r,e,n;Re++,r=_e,e=[],(n=en())===a&&(n=Ye())===a&&(n=We())===a&&(32===t.charCodeAt(_e)?(n=zr,_e++):(n=a,0===Re&&Pe(Ur)));if(n!==a)for(;n!==a;)e.push(n),(n=en())===a&&(n=Ye())===a&&(n=We())===a&&(32===t.charCodeAt(_e)?(n=zr,_e++):(n=a,0===Re&&Pe(Ur)));else e=a;e!==a&&(r,e=Zr(e));Re--,(r=e)===a&&(e=a,0===Re&&Pe(Xr));return r}())!==a&&(r,e=E(e)),r=e))),r}function Be(){var t,r;return t=_e,rn()!==a&&(r=Xe())!==a&&rn()!==a?(t,t=R(r)):(_e=t,t=a),t===a&&(t=_e,rn()!==a&&(r=Ye())!==a&&rn()!==a?(t,t=R(r)):(_e=t,t=a),t===a&&(t=_e,rn()!==a&&(r=en())!==a&&rn()!==a?(t,t=R(r)):(_e=t,t=a))),t}function De(){var r,e;return r=_e,102===t.charCodeAt(_e)?(e=N,_e++):(e=a,0===Re&&Pe(S)),e===a&&(103===t.charCodeAt(_e)?(e=q,_e++):(e=a,0===Re&&Pe(F)),e===a&&(104===t.charCodeAt(_e)?(e=M,_e++):(e=a,0===Re&&Pe(P)))),e!==a&&(r,e=L(e)),r=e}function Ie(){var t,r;return t=_e,rn()!==a&&(r=Xe())!==a&&rn()!==a?(t,t=G(r)):(_e=t,t=a),t===a&&(t=_e,rn()!==a?((r=Ye())===a&&(r=en()),r!==a&&rn()!==a?(t,t=G(r)):(_e=t,t=a)):(_e=t,t=a)),t}function Je(){var t,r;return t=_e,rn()!==a&&(r=Xe())!==a&&rn()!==a?(t,t=R(r)):(_e=t,t=a),t===a&&(t=_e,rn()!==a&&(r=tn())!==a&&rn()!==a?(t,t=Nt(r)):(_e=t,t=a)),t}function Ke(){var r,e;return r=_e,t.substr(_e,4)===Gt?(e=Gt,_e+=4):(e=a,0===Re&&Pe(Ht)),e===a&&(t.substr(_e,4)===Xt?(e=Xt,_e+=4):(e=a,0===Re&&Pe(zt)),e===a&&(t.substr(_e,4)===Ut?(e=Ut,_e+=4):(e=a,0===Re&&Pe(Zt)),e===a&&(t.substr(_e,3)===Bt?(e=Bt,_e+=3):(e=a,0===Re&&Pe(Dt)),e===a&&(t.substr(_e,3)===It?(e=It,_e+=3):(e=a,0===Re&&Pe(Jt)),e===a&&(t.substr(_e,3)===Kt?(e=Kt,_e+=3):(e=a,0===Re&&Pe(Qt)),e===a&&(t.substr(_e,3)===Vt?(e=Vt,_e+=3):(e=a,0===Re&&Pe(Wt)),e===a&&(t.substr(_e,3)===Yt?(e=Yt,_e+=3):(e=a,0===Re&&Pe(tr)),e===a&&(t.substr(_e,3)===rr?(e=rr,_e+=3):(e=a,0===Re&&Pe(er)),e===a&&(t.substr(_e,3)===nr?(e=nr,_e+=3):(e=a,0===Re&&Pe(ar)),e===a&&(t.substr(_e,4)===sr?(e=sr,_e+=4):(e=a,0===Re&&Pe(or)),e===a&&(t.substr(_e,4)===ur?(e=ur,_e+=4):(e=a,0===Re&&Pe(ir)),e===a&&(t.substr(_e,6)===cr?(e=cr,_e+=6):(e=a,0===Re&&Pe(lr)),e===a&&(t.substr(_e,6)===fr?(e=fr,_e+=6):(e=a,0===Re&&Pe(hr)),e===a&&(t.substr(_e,6)===gr?(e=gr,_e+=6):(e=a,0===Re&&Pe(dr)),e===a&&(t.substr(_e,6)===pr?(e=pr,_e+=6):(e=a,0===Re&&Pe(br)),e===a&&(t.substr(_e,6)===mr?(e=mr,_e+=6):(e=a,0===Re&&Pe(vr)))))))))))))))))),e!==a&&(r,e=xr(e)),r=e}function Qe(){var t;return(t=Ye())===a&&(t=en()),t}function Ve(){var r,e,n;return r=_e,(e=Ge())!==a?(t.substr(_e,2)===Gr?(n=Gr,_e+=2):(n=a,0===Re&&Pe(Hr)),n!==a?(r,r=e=G(e)):(_e=r,r=a)):(_e=r,r=a),r}function We(){var r,e;return r=_e,Br.test(t.charAt(_e))?(e=t.charAt(_e),_e++):(e=a,0===Re&&Pe(Dr)),e!==a&&(r,e=Ir(e)),r=e}function Ye(){var r,e;return r=_e,Jr.test(t.charAt(_e))?(e=t.charAt(_e),_e++):(e=a,0===Re&&Pe(Kr)),e!==a&&(r,e=Qr(e)),(r=e)===a&&(r=_e,(e=tn())!==a&&(r,e=Vr(e)),r=e),r}function tn(){var r;return Re++,t.substr(_e,3)===Yr?(r=Yr,_e+=3):(r=a,0===Re&&Pe(te)),r===a&&(t.substr(_e,6)===re?(r=re,_e+=6):(r=a,0===Re&&Pe(ee)),r===a&&(t.substr(_e,6)===ne?(r=ne,_e+=6):(r=a,0===Re&&Pe(ae)),r===a&&(t.substr(_e,5)===se?(r=se,_e+=5):(r=a,0===Re&&Pe(oe)),r===a&&(t.substr(_e,7)===ue?(r=ue,_e+=7):(r=a,0===Re&&Pe(ie)),r===a&&(t.substr(_e,6)===ce?(r=ce,_e+=6):(r=a,0===Re&&Pe(le)),r===a&&(t.substr(_e,8)===fe?(r=fe,_e+=8):(r=a,0===Re&&Pe(he)),r===a&&(t.substr(_e,4)===ge?(r=ge,_e+=4):(r=a,0===Re&&Pe(de)),r===a&&(t.substr(_e,6)===pe?(r=pe,_e+=6):(r=a,0===Re&&Pe(be)),r===a&&(t.substr(_e,6)===me?(r=me,_e+=6):(r=a,0===Re&&Pe(ve)),r===a&&(t.substr(_e,6)===xe?(r=xe,_e+=6):(r=a,0===Re&&Pe(Ce)))))))))))),Re--,r===a&&(a,0===Re&&Pe(Wr)),r}function rn(){var r,e;for(Re++,r=[],we.test(t.charAt(_e))?(e=t.charAt(_e),_e++):(e=a,0===Re&&Pe(ye));e!==a;)r.push(e),we.test(t.charAt(_e))?(e=t.charAt(_e),_e++):(e=a,0===Re&&Pe(ye));return Re--,r===a&&(e=a,0===Re&&Pe(Ae)),r}function en(){var r,e,n;if(r=_e,e=[],Ee.test(t.charAt(_e))?(n=t.charAt(_e),_e++):(n=a,0===Re&&Pe(Te)),n!==a)for(;n!==a;)e.push(n),Ee.test(t.charAt(_e))?(n=t.charAt(_e),_e++):(n=a,0===Re&&Pe(Te));else e=a;return e!==a&&(r,e=$e(e)),r=e}let nn={"\\pi":"π","\\infty":"∞","\\alpha":"α","\\epsilon":"ε","\\beta":"β","\\lambda":"λ","\\gamma":"γ","\\rho":"ρ","\\delta":"δ","\\sigma":"σ","\\theta":"θ"};class an{constructor(t,r){this.arg=r,this.type=t}}class sn extends an{constructor(t,r,e){super("function",r),this.name=t,this.exponent=e}}class on extends an{constructor(t){super("calcunit",t)}}class un extends an{constructor(t,r){super("expression",t),this.bracketType=r}}class cn extends an{constructor(t){super("char",t)}}class ln extends an{constructor(t,r){super("environment",r),this.envType=t}}if((e=o())!==a&&_e===t.length)return e;throw e!==a&&_e<t.length&&Pe({type:"end"}),Le(je,Oe<t.length?t.charAt(Oe):null,Oe<t.length?Me(Oe,Oe+1):Me(Oe,Oe))}}}])}));